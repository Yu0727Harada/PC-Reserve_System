<!doctype html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>index</title>
<link rel="stylesheet" type="text/css" href="guide.css">
</head>
<body>
	<a href="https://github.com/Yu0727Harada/PC-Reserve_System">githubのURL</a>　 
	<h1>PC予約表　使い方</h1>
	<p>マクロ作成者連絡先（バグ報告など）→GitHubを参照してください</p>

	<ul>
		<li>7/26 Ver.β1.43に合わせて一部加筆修正</li>
		<li>9/21 大幅に加筆・修正。UIの変更に伴い画像の変更を行った</li>
		<li>9/26　一部機能の追記</li>
		<li>9/29　一部機能の追記</li>
		<li>10/14 追記(プロフィール画面の編集の仕方、github)</li>
		<li>10/29 コントロールパネル、エラー追記</li>
		<li>11/6　GitHubのURLを追記5. エラー処理＆困った時の処理リストーバグの報告、予約表のアップデートなど項作成</li>
		<li>11/8　番号が0のプロフィールについての特殊動作について追記。画像の差し替え。一部補足的説明を追記。</li>
	</ul>
	<div class="index">
		<h2>目次</h2>
		<ol>
			<li>
				<a href="#how_to_reserve">予約を取るための基本的な使い方</a>
				<ul>
					<li>新規予約</li>
					<li>既存予約の変更</li>
					<li>メインページの表示する日付の変更</li>
				</ul>
			</li>
			<li>LAとしての運営のための基本的な使い方
				<ul>
					<li>生データを編集する</li>
					<li>LAコントロールパネル
						<ol>
							<li>LAコントロールパネルの表示の仕方</li>
							<li>コントロールパネルの個々のボタンの説明</li>
						</ol>
					</li>
					<li>現在の予約状況を確認（各予約の人数を確認する）</li>
					<li>LAのプロフィールを設定する</li>
					<li>番号が0のプロフィールについての特殊動作(11/8追記)</li>
					<li>シフトを読み込む</li>
				</ul>
			</li>
			<li>
				システムのカスタマイズ
				<ul>
					<li>VisualBasicの開き方,スクロールバー、数式バー、各メニュータブの表示・非表示の設定</li>
					<li>パスコードの設定</li>
					<li>メインシートの各セルの位置を変更する</li>
					<li class="line">1日の予約条件数を変更する</li>
					<li>シフト表の各セルの位置を変更する</li>
					<li>プロフィールのテキストボックスなどのカスタマイズをする</li>
					<li>LAプロフィールユーザーフォームの設定</li>
				</ul>
			</li>
			<li>シフトの作成
				<ul>
					<li>日付の入力</li>
					<li>シフト表リセットボタン</li>
					<li>シフト時間帯取得</li>
					<li>セルの色設定</li>
				</ul>
			</li>
			<li>エラー処理＆困った時の処理リスト
				<ul>
					<li>バグの報告、予約表のアップデートなど</li>
					<li>予約表固有エラー</li>
					<li>VBAエラー</li>
					<li>予約表に予約済と表示されない</li>
					<li>予約表の背景色が設定されない</li>
					<li>時計が更新されない</li>
				</ul>
			</li>
			<li>開発を進める上での基本的な仕様
				<ul>
					<li>全体の概要</li>
					<li>メインシートの表のセル内の式</li>
				</ul>
			</li>
		</ol>
	</div>

	<ol class="main-contents">
		<li id="how_to_reserve" class="content">
			<h2>予約を取るための基本的な使い方</h2>
			<ul>
				<li class="item" id="new_resrve">
					<h3>新規予約</h3>
					<ol>
						<li>
							<h4>エクセルファイルを開きメインシートを開きます。</h4>
						</li>
						<li>
							<h4>予約したい時間帯、席番号のセルを選択する(11/8　画像差替)</h4>
							<img src="image/1-1.png" alt="予約の仕方">
						</li>
						<li>
							<h4>予約フォームが表示される。</h4>
							<p>
								テキストボックス5つのうち１つ以上にに学籍番号7桁(M,D,Sを含む番号も入力可能)か、学生証台帳番号16桁の数字を入力してください。もしくはバーコードをスキャンしてください。<br>
								<img src="image/1-2.png" alt="予約フォーム">
								2コマ使用希望にチェックを入れると2コマ連続で予約を取ることができます。HDMIケーブルなどを貸し出し希望にチェックを入れると予約ステータスが変化します。（後述）<br>
							</p>
							<p>
								必要事項を入力したら、下の登録ボタンをクリックします。<br>
								この時、予約が1日の中で一定数以上に達している場合、予約を取るかどうかの確認ダイアログが出ます。（一日に取れるコマの設定の仕方は<a href="#">2.LAとしての運営のための基本的な使い方・LAコントロールパネル９.一日の上限数参照</a>
								<img src="image/1-3.png" alt="予約制限オーバーの時">
							</p>
							<p>
								いいえをクリックすると予約画面に移動します。<br>
								はいをクリックすると、LAを呼んでパスコードを入力するように促されます。（<a href="#">3.システムのカスタマイズ―パスコードの設定参照</a>）<br>
								パスコードの入力が正しければ予約され、間違っていれば予約画面に移動します。
								<img src="image/passcord.png" alt="パスコードを要求される"><br>
							</p>
						</li>
						<li>
							<h4>メインシートで選択した日時、席番号箇所が予約済と表示されます。</h4>
							<p>
								現在の時間帯の場合は使用中、現在以降の時間帯の場合には予約済、マスタモード（<a href="#">2.LAとしての運営のための基本的な使い方-LAコントロールパネル-２．コントロールパネルの個々のボタンの説明参照</a>）などで入力した場合などは使用済と表示されます。ケーブル貸し出しにチェックを入れた場合は予約済(貸出中)と表示されます。（11/8　追記ここまで）
							</p>
						</li>
					</ol>
				</li>>

				<li class="item" id="vary_reserve">
					<h3>既存予約の変更</h3>
					<p>
						予約済か、使用中と表示されているセルをクリックすると予約の変更などフォームが表示されます。マスターモードの場合は使用済のセルをクリックしても表示されます。（<a href="#">マスターモードについて参照する</a>）<br>
						<img src="image/vary_resrve.png" alt="予約変更フォーム"><br>
					</p>
						<ul>
							<li>
								利用者の追加をクリックすると利用者の追加フォームが表示され、新規予約同様に番号を入力することで、予約者の追加を行うことが出来ます。
								<img src="image/add_user.png" alt="利用者の追加"><br>
							</li>
							<li>
								延長をクリックすると、1コマ分延長することが出来ます。<br>
							</li>
							<li>
								予約の取り消しを押すと取り消しフォームが出ます。
								<img src="image/delete_resrve.png" alt="予約の取り消し">
								<p>
									LAのパスコードを入力するか、取り消したい予約を行なった人、誰か一人の学籍番号か台帳番号を入力することで予約を取り消すことが出来ます。（<a href="#">3.システムのカスタマイズ-パスコードの設定参照</a>）<br>
									<span class="red">この時、正しく入力していても取り消せない場合があります。</span>これは学籍番号を台帳番号に変換する際に不具合があるからです。具体的には下の画像の黄色の学科の台帳番号は実際にそうであるか不明で仮での変換です。そのため、変換がうまくいかず、取り消しの認証がされません。もしそのような人がいた場合はパスコードを入力して対処してください。<br>
									また、できれば正確な台帳番号が手に入れば更新してください。（更新の仕方→<a href="#">GitHubで報告していただければ対応します</a>）<br>
									<img src="image/student_number_list.png" alt="変換表">
								</p>
							</li>
							<li>
								ケーブル貸し出しボタンをクリックすると、貸し出しのステータスが変化します。
							</li>
						</ul>
				</li>

				<li class="item" id="vary_date">
					<h3>メインページの表示する日付の変更</h3>
					<img src="image/vary_time.png" alt="日付の変更">
					<p>	表示されている予約表はK2セルに入力されている日付に従って表示しています。通常はセルの中身は「=today()」としていますが「=today()-1」とすることで昨日の予約表を表示したり、「8/1」などと入力することで、過去や未来の日付の予約表を表示し、その日付の予約をすることが出来ます。<br>
					過去の日付を表示した場合は予約はできませんが、未来の日付を表示した場合は全ての時間帯で予約できます。<a href="#">2.LAとしての運営のための基本的な使い方-LAコントロールパネル-コントロールパネルの個々のボタンの説明するマスターモード</a>を用いることで過去の予約の編集も可能となります<br>
					日付を変更した場合、すぐに予約表が更新されないので<a href="#">LAコントロールパネルの定期再計算再実行ボタン</a>を2回ほど実行してください。</p>
				</li>
			</ul>
		</li> 
		<li class="content" id="how_to_as_administer">
			<h2>LAとしての運営のための基本的な使い方</h2>
			<ul>
				<li class="item" id="edit_rawdata">
					<h3>生データを編集する</h3>
					<p>予約をした際に、データは全て生データシートに格納されます。</p>
					<img src="image/raw_data.png" alt="生データ">
					<p>
						A列の予約日はyyyymmdd形式で予約した日付、B列の予約時間帯は予約したコマが入力されます。（1→1限目、2→2限目、3→昼休み、4→3限目、5→4限目というように対応しています）<br>
						C列の席番号は予約したPC席の番号、D列の予約コードは日付と予約時間帯、席番号を合わせた、データ処理用のコード番号を、E列はケーブルを貸し出しているかどうか、1は貸し出し中、0は貸し出していない場合を表示します。F列からは入力された台帳番号を省略した<span class="red">独自の番号</span>を表示しています。（フォームから学籍番号を入力すると自動的に変換されます）<br>
						直接ここに入力することで予約を編集することも可能です。<br>
						また学籍番号を入力するセルに文字列を入力するとその入力した文字列が表示されます。機材の不調や貸切など、特殊なステータスが必要な場合に利用することが出来ます。（表からの予約も不可になります）<span class="red">逆に言うとここにMとかDを含む学籍番号を入れるとそれがそのまま表示されてしまうので入力する場合は台帳番号を入力するか、他の数字に置き換えて入力してください。メインシートの右のほうには変換表もあるので参照してください</span>
						<img src="image/paticular_resrve.png" alt="特殊ステータス表示">
						<img src="image/paticular_status_data.png" alt="特殊ステータス表示生データ"><br>
						<span class="red">直接入力した場合は<a href="#">メインシートソートボタン</a>をクリックするか、予約コードをキーとして昇順で並び替えを行ってください。（match関数の近似値一致で検索するため。軽量化のために行ったため、今後変更の予定は現状ありません）</span>
					</p>
				</li>
				<li class="item">
					<h3>LAコントロールパネル(9/22追記)</h3>
					<ol>
						<li>
							<h4>LAコントロールパネルの表示の仕方(9/22追記)</h4>
							<p>
								通常シートのスクロールバーを非表示にしています。メインシートの右側にLAコントロールパネルがあります。これを操作するためにはスクロールバーを表示する必要があります。予約表の右下にある歯車ボタンをクリックするとパスコードを要求されます。<br>
								<img src="image/geer.png" alt="歯車ボタン">
								パスコードの入力が完了するとスクロールバーが表示されます。（既に表示されていた場合には非表示になるます。）スクロールバーを操作して予約表の右側のコントロールパネルを表示させます。<br>
								<img src="image/compane_outline.png" alt="コントロールパネル">
							</p>
						</li>
						<li>
							<h4>コントロールパネルの個々のボタンの説明</h4>
							<ul>
								<li>
									<h5>表示／非表示オプション</h5>
									エクセルの外見について操作することができます。利用者に意図しない操作をさせないためにも、基本的に全ての項目を非表示にし、シートを保護した状態にしてください。
								</li>
								<li>
									<h5>マクロ実行ボタン</h5>
									<ul>
										<li>
											<h6>生データソート</h6>
											<p>
												生データシートに入力されているデータを予約コードをキーにして昇順でソートします。<br>
												こんな時に→予約ずみと表に表示されない時
											</p>
										</li>
										<li>
											<h6>シフトシートソート</h6>
											<p>
												シフト表シートを勤務終了時刻をキーとして昇順にソートします。シフトが意図した通りに読み込まれない場合などに用いてください。
											</p>
										</li>
										<li>
											<h6>マクロ再実行</h6>
											<p>
												メインシートは1分ごとに再計算を行なっていますが、たまに止まります。（エラーが出た時、マクロの編集をした時など）時刻の更新が一定時間（2分以上）されない場合はシートの再計算が実行されてないので、このボタンを押してください。<br>
												こんな時に→（11/8　追記）日付を変更した場合（11/8　追記ここまで）予約済と出るのに表に色がつかない現象が恒常的に起こる。 時刻が更新されない、あるいは表示されている時刻が0:00などおかしい<br>
												その他大概の不具合がこれで治ると思います。治らなかったらエクセルを再起動してください
											</p>
										</li>
										<li>
											<h6>ワークシート再計算</h6>
											<p>
												メインシートの再計算を行います。<br>
												こんな時に→予約をしたのに表に予約ずみと表示されない時、時刻が更新されない時
											</p>
										</li>
										<li>
											<h6>重複チェックシートリフレッシュ</h6>
											<p>
												予約している人のそれぞれのその日の予約数を記録している重複チェックシートを一度クリアして、新たに人数を数え直します。<br>
												こんな時に→エラー処理でこれをするように指示された時。予約数絡みでなんかおかしいとき。
											</p>
										</li>
									</ul>
								</li>
								<li>
									<h5>入力モード切り替え</h5>
									<ul>
										<li>
											<h6>マスター入力モード</h6>
											<p>当日の過ぎた時間帯でも予約・予約の変更取り消しなどができるようになります。パスコードの入力が必要です<br>
												こんな時に→入力データを修正したい、過去のデータを入力したい</p>
										</li>
										<li>
											<h6>選択カーソル強制移動</h6>
											<p>選択カーソルを強制的に移動するように設定できます。運用の際にはonにすることで、繰り返し同じセルをクリックすることが可能になります。パスコードの入力が必要です。編集作業などをする際には邪魔になるのでオフにすると便利です。</p>
										</li>
									</ul>
								</li>
								<li>
									<h5>勤務中のシフト番号</h5>
									<p>
										勤務中のLAの番号を表示します。この番号を参照してプロフィールを表示しています。<br>
										基本的にここに表示される番号は５つまでです。表示するプロフィールの数は別途設定できます。<a href="#">３．システムのカスタマイズのメインシートの各セルの位置を変更するを参照</a>してください
									</p>
									<ul>
										<li>
											<h6>シフト追加</h6>
											<p>
												新しく現在の時刻から勤務する人を追加することができます。
												<img src="image/add_shift.png" alt="シフトの追加">
												勤務する人、勤務する時間を選択し登録ボタンを押すと、現在の時刻から選択した時間までのシフトが追加されます。この時、時間の選択は任意です。選択しなかった場合自動的に2時間となります。<br>
												登録したあとすぐにシフト番号が表に表示されないことがあります。その時は<a href="#">マクロ再実行ボタン</a>を押してください。
											</p>
										</li>
										<li>
											<h6>シフト編集</h6>
											<p>
												現在勤務しているシフトを削除、勤務終了時刻を現在の時刻に設定することができます。
											</p>
										</li>
									</ul>
								</li>
								<li>
									<h5>予約制限</h5>
									<ul>
										<li>
											<h6>一日の上限数</h6>
											<p>
												左のセルの数字を変更することで一日の予約可能数を変更することができます。文字列を入力すると36と認識され、「予約制限はありません」と表示されます。
											</p>
										</li>
										<li>
											<h6>予約制限</h6>
											<p>
												左のオンオフの切り替えを行うことで予約の制限を行うことができます。オンにすると現在のコマのみ予約可能となり、先のコマの予約ができなくなります。（すでに予約されているコマは編集可能）<br>
												またオンにすると予約の仕方に予約制限中である旨が表示されます<br>
												オンにしてるときに先のコマを予約しようとすると、予約制限中であることを知らせるウィンドウを出すようにしました。また、延長、２コマ連続予約にも制限がかかるようにしました。
											</p>
										</li>
									</ul>
								</li>
								<li>
									<h5>開発</h5>
									<ul>
										<li>
											<h6>VBEを開く</h6>
											<p>
												マクロの編集を直接できるVisualBasicEditorを開くことができます。
											</p>
										</li>
										<li>
											<h6>パスコードの追加/削除</h6>
										</li>
										<li>
											<h6>エクセルファイルのアップデート</h6>
										</li>
									</ul>
								</li>
							</ul>
							<p class="red">基本的に挙動がおかしい時は、定期再計算再実行とメインシートセッティングと生データソートをガチャ押しすれば治りますので、よく分からない時はガチャ押ししてください。<br>
								また、エラーによってはこのボタンを押してくださいと出るので、その時に、指定のボタンを押してください。押してリカバリーの効かない操作のボタンはありませんので、押すことをためらう必要はありません。</p>
						</li>
					</ol>
				</li>

				<li class="item">
					現在の予約状況を確認（各予約の人数を確認する）（9/29追記）（11/8画像差し替え、一部修正）
					<p>予約の人数を確認するために、LAコントロールパネルの右側に予約している学生の台帳番号（短縮版）がすべて表示される表をつくりました。</p>
					<img src="image/observe_resrve.png" alt="予約状況の確認">
					<p>現在表示している時間帯コードの右のセルにマクロで現在の時刻を表す数値が入ります。（マクロではpublic変数のon_timeのことです）１は１限目、で一つコマが進むごとにずれていき（時刻とともに自動で更新されます）、８は閉室後以降（表外）を表します。この表はこのセルに入っている時刻での予約状況を示しています。時間帯のセルを直接編集することで自由に時間帯の予約状況を確認することもできます。</p>
					<p>（開発用　セルの中の式）
					=IFERROR(IF(INDEX(生データ!$D:$D,MATCH(OFFSET($D$22,$Z4-1,$AA$3-2),生データ!$D:$D,1))=OFFSET($D$22,$Z4-1,$AA$3-2),VLOOKUP(OFFSET($D$22,$Z4-1,$AA$3-1),生データ!$D:$O,COLUMN(C1),TRUE),""),0)
					</p>
					<p>メインシートのD22周辺に予約コードを生成して出力しておく場所があります。それをmatch＋index関数で参照しますが、今回は時間帯セルに合わせてD22セルから移動して参照してほしいのでoffset関数を用いて、D22セルから移動させます。<br>
					Match＋index関数で参照した先が一致した場合（if文Trueの場合）はVLOOKUPの二分探索（True）で生データシートを探索に行きます。この時、列の位置はColumn関数で指定することで右側にコピペしたときに順に参照位置がずれるようにします。一致しなかった場合は“”を吐くように設定。<br>
					Iferrorは時間帯セルに８が来たときにN/Aエラーを吐くのでそれを防止するため。(9/29追記ここまで)</p>
				</li>
				<li class="item">
					LAのプロフィールを設定する(9/22追記)
					<p>メインシートの右側に表示しているLAのプロフィールを変更したい時は入力シートに入力します。</p>
					<img src="image/input_profile.png" alt="入力シート">
					<p><span class="line">A列に入力した番号に応じて、プロフィールを表示させようと思いましたが、コード書くのが面倒になり現状はここに上から入力した順に番号が自動的に振られるのと同等です。（ここで2列目に3と書いても、シフト番号3の時には4列目に入力されてるデータが表示されます）そのうちindex+matchに直したいです。</span><br>
					（11/8 追記）index+match関数に直したので、A列に入力した番号が出力シートのA列に入力されます。また、プロフィールボタンを押して出力すると自動的にA列でソートされます（11/8 追記ここまで）<br>
					B列、C列、D列に書いた内容は同じテキストボックスで出力されます。E列を選択するとファイル選択ダイアログが出てくるので、表示させたい画像を選択すると、出力時に自動でトリミングなど行います。F列に入力された文字はプロフィール下部に表示されます。</p>
					<img src="image/profile.png" alt="プロフィール出力">
					<p>出力シートを見るとこのように出力されます。出力シートの枠線を表示するとメインシートに出力した時にも枠線が見えるようになります。（LAコントロールパネル(9/22追記)(1)LAコントロールパネルの表示の仕方を参照してください）<br>
					出力シートを直接変更してもメインシートでの表示に反映されます。出力の位置を変えたい場合には・プロフィールのテキストボックスなどのカスタマイズをするを参照してください。
					</p>
				</li>
				<li class="item">
					番号が0のプロフィールについての特殊動作(11/8追記)
					<p>番号が０のプロフィールは特殊な扱いを受けます。シフト表に０の番号が入力されていた場合はそのプロフィールの表示をスキップします。番号が０のプロフィールが表示されるのは現在の時間帯に勤務している人が誰もいない時です。（≒シフト表に現在の時間帯の入力がない場合）誰も勤務している人がいないときに表示させたいメッセージなどを設定したりすることが可能です。</p>
				</li>
				<li class="item">
					シフトを読み込む(9/22追記)
					<p>別ファイルで作成したシフト表を読み込むことで、メインシートにプロフィールを表示することができます。</p>
					<ol>
						<li>
							シフト表シートを選択します。
							<img src="image/shift_1.png" alt="シフト読み込み1"><br>
						</li>
						<li>
							A列には勤務時間の開始時刻、B列には終了時刻、C列にはシフト表の入力時の番号が入力されています。
							<img src="image/shift_2.png" alt="シフト読み込み2">
						</li>
						<li>
							シフト読み込みボタンを押すとファイル選択ダイアログが出ます。読み込みたいシフト表のファイルを選択します。
							<img src="image/shift_3.png" alt="シフト読み込み3">
						</li>
						<li>
							この時、すでに読み込んだ期間のシフトの場合は読み込むかどうかの許可を求めるダイアログが出ます。キャンセルを押すと処理を終わります。OKを押すとすでに入力されている日のシフトを上書きしてシフトを読み込みます。
							<img src="image/shift_4.png" alt="シフト読み込み4">
						</li>
						<li>
							シフトの読み込みは勤務時間終了時間をキーに昇順並び替えで読み込んでいます。手で訂正した場合は並び替えを行なってください。
						</li>
					</ol>
				</li>
			</ul>
		</li>
		<li class="content">
			<h2>システムのカスタマイズ(9/22追記)</h2>
			<ul>
				<li class="item">
					VisualBasicの開き方
					<p>システムカスタマイズを行うためにはマクロの編集をする必要があります。マクロの編集をするにはVisualBasicを開く必要があります。</p>
					<ol>
						<li>
							ファイル→オプションを選択してオプションを開きます。リボンのユーザー設定から開発のチェックを入れます。
							<img src="image/vb_open1.png" alt="VBの開き方1">
						</li>
						<li>
							開発タブが表示されるので、開発タブのvisualBasicを選択します。
							<img src="image/vb_open2.png" alt="VBの開き方2">
						</li>
						<li>
							VisualBasicの画面が表示されます。
							<img src="image/vb_open3.png" alt="VBの開き方3">
						</li>
					</ol>
				</li>
				<li class="item">
					パスコードの設定(9/22追記)
					<p>予約表の操作には利用者に操作されては困りそうな操作にはパスコードの入力を求めるようにしています。パスコードはマクロを変更することでいつでも変更ができます。</p>
					<ol>
						<li>
							VisalBasicを開き、標準モジュールフォルダのModule1を選択します。
							<img src="image/passcord_1.png" alt="パスコード設定1"><br>
							<p>このウィンドウがない場合は表示→プロジェクトエクスプローラーを選択することで表示されます。</p>
							<img src="image/passcord_2.png" alt="パスコード設定2">
						</li>
						<li>
							module1が表示されます。
							<img src="image/passcord_3.png" alt="パスコード設定3">
							<p>「Public const passcord as string = 」というのがあります。この＝の次の数字がパスコードです。この数字を変えることでパスコードを変更することができます。</p>
						</li>
					</ol>
				</li>
				<li class="item">
					メインシートの各セルの位置を変更する
					<p>パスコードと、モジュールを開くとこまでは同じです。パスコードの下に書いてある文字を変更することで位置を変更することができます。</p>
					<img src="image/design_1.png" alt="位置変更1">
					<p>各変数の表しているセルの位置を図にしめしてあります。Columnの綴りが間違っている箇所がありますので、誰か直してください。他にもタイポしてたりするのですみません。メインシートのデザインを変更した際などに数字を調整してください。</p>
					<img src="image/design_2.png" alt="位置変更2">
				</li>
				<li class="item">
					<span class="line">1日の予約条件数を変更する(9/22追記)</span>
					<p><span class="line">一日に予約できる上限数を変更したい場合は、パスコードを変更するのと同様に変更します。Public const limit_res_day as integer = の次の数字を変更することで上限数を変更することができます。</span><br>
					LAコントロールパネルで予約件数を変更できるようにしました。</p>
				</li>
				<li class="item">
					シフト表の各セルの位置を変更する(9/22追記)
					<p>別ファイルのシフト表作成ファイルのセルの位置を変更した場合などは3.システムのカスタマイズ-メインシートの各セルの位置を変更するを参照して、以下の数字変更してください。各変数の表すセルの位置は図に示しました。</p>
					<img src="image/design_shift_1.png" alt="シフト位置変更1">
					<img src="image/design_shift_2.png" alt="シフト位置変更2">
				</li>
				<li class="item">
					プロフィールのテキストボックスなどのカスタマイズをする(9/22追記)
					<p>VisualBasicの開き方を参照してvisualBasicを開きます。Module2を開きます。</p>
					<img src="image/design_profile_1.png" alt="プロフィール位置調整1">
					<img src="image/design_profile_2.png" alt="プロフィール位置調整2">
					<p>Module2の中にテキストボックスを出力するコードがあります。一番上の方にあるT,L,W,Hと書かれているところが名前と所属をテキストボックスの出力をコントロールする部分です。</p>
					<img src="image/design_profile_3.png" alt="プロフィール位置調整3">
					<p>少し下の行に書かれているT2、L2、W2、H2という変数を先ほどの要領で調整することで、コメント部分の出力位置を変更できます。</p>
					<img src="image/design_profile_4.png" alt="プロフィール位置調整4">
					<p>さらに下の行には画像の出力位置を調整する変数があります。先ほどの要領でslection.top,selection.left,selection.widthを変更することで出力位置を変更できます。</p>
					<img src="image/design_profile_5.png" alt="プロフィール位置調整5">
					<p>msoshapeOvalは楕円を指定しています.他の形にも出来ます（ググって）</p>
					<img src="image/design_profile_6.png" alt="プロフィール位置調整6">
				</li>
				<li class="item">
					LAプロフィールユーザーフォームの設定(10/14追記)
					<p>LAの詳しいプロフィールを閲覧できるユーザーフォームを設定することができます。VisualBasicを開き、フォームフォルダのProfileをクリックします。</p>
					<img src="image/design_prfile_tab.png" alt="プロフィールタブ設定">
					<p>プロフィール画面が表示され、編集することができます。ツールボックスを使用することで画像やテキストを配置することができます。</p>
					<img src="image/design_profile_tab_2.png" alt="プロフィールタブ設定">
					<img src="image/design_profile_tab_3.png" alt="プロフィールタブ設定">
					<p>ツールボックスの説明です。（使いそうなものの最低限しかしませんので、あとはGoogle先生に聞いてください）</p>
					<ul>
						<li>矢印は選択ツールで、オブジェクト（画像とかテキストとか）を選択しプロパティウィンドウ（後述）でオブジェクトのプロパティ（表示するテキストとか、フォントとか画像パスとか）を編集することができます。</li>
						<li>Aのアイコンは選択するとラベル（ワード的に言えばテキストボックス）をユーザーフォーム上でドラックすることで作成できます。</li>
						<li>真ん中の行のルーズリーフのインデックスのようなアイコンをクリックしてドラッグすると、タブで選択できるエリアを作成することができます。</li>
						<li>右下の青い波立ってる的な画像アイコンを選択すると画像エリアをユーザーフォーム上でドラッグすることで作成できます。</li>
					</ul>
					<p>上記の通りでラベルエリアや画像エリアを作った後はプロパティウィンドウでフォントやテキスト、画像の貼り付けを行います。プロパティウィンドウは通常プロジェクトウィンドウの下に表示されています。</p>
					<img src="image/proprety_window.png" alt="プロパティウィンドウ">
					<p>表示されていない場合はメニューバーの表示→プロパティウィンドウで表示できます。</p>
					<img src="image/property_window_2.png" alt="プロパティウィンドウ2">
					<img src="image/property_window_3.png" alt="プロパティウィンドウ3">
					<p>選択ツールでオブジェクトを選択、プロパティを編集することで色々いじれます。1から10まで解説するのはしませんがある程度直感でいじれます。ある程度書いておきます。</p>
					<ul>
						<li>BackColor オブジェクトの背景色を設定します</li>
						<li>BackStyle 背景の有無の選択。0(transparent)→透明　1(opaque)→BackColorで選択した色を表示</li>
						<li>BorderColor  オブジェクトの境界線（輪郭線）の色を設定します。</li>
						<li>BorderStyle 境界線の有無の設定</li>
						<li>Caption ラベルに表示するテキストの設定します</li>
						<li>Enabled オブジェクトが実際にエクセルのデータで表示されるかを設定します</li>
						<li>Font フォントの設定</li>
						<li>ForeColor 文字の色</li>
						<li>Height オブジェクトの高さ</li>
						<li>Left オブジェクトの横の長さ</li>
						<li>Specialeffect オブジェクトを立体的に見せたりできる</li>
						<li>TextAlign テキストの中央揃え、左揃えなどの設定</li>
						<li>Picture 表示する画像をファイルダイアログから選べます</li>
					</ul>
					<p>(10/14 追記ここまで)</p>
				</li>
			</ul>
		</li>
		<li class="content">
			<h2>シフトの作成(9/22追記)</h2>
			<p>別ファイルのシフト表作成ファイルを用いることでシフトを作成することができます。</p>
			<ul>
				<li class="item">
					<h3>日付の入力</h3>
					<p>作成するシフトの期間を入力します。</p>
					<img src="image/make_shift_1.png" alt="シフト表日付の入力">
					<p>シフト表の下には様々な操作を行うボタンが用意されています。</p>
				</li>
				<li class="item">
					<h3>シフト表リセットボタン</h3>
					<p>シフト表の勤務日時が入力されているエリアの文字と背景色をリセットします。リセットする前には確認ダイアログが出ます。</p>
				</li>
				<li class="item">
					<h3>シフト時間帯取得</h3>
					<p>入力されているシフトの勤務の要素をB21セル以下に抽出します。すでにB21以下セルに入力されている場合は上書きせず、無かった場合は要素を追加します。</p>
					<img src="image/make_shift_2.png" alt="シフト表取得">
				</li>
				<li class="item">
					<h3>セルの色設定</h3>
					 <p>B21セル以下に入力された時間帯の右のセル背景色をシフト表に反映します。B21セル以下の色設定は以前のシフト表ファイルからコピペして貼った場合もきちんと反映されます。</p>
				</li>
			</ul>
		</li>
		<li class="content">
			<h2>エラー処理＆困った時の処理リスト(9/22追記)</h2>
			<ul>
				<li class="item">
					<h3>バグの報告、予約表のアップデートなど（11/6追記）</h3>
					 <p>
						 予約表のマクロはGitHubにアップロードしています。<br>
						 URL　 <a href="https://github.com/Yu0727Harada/PC-Reserve_System">https://github.com/Yu0727Harada/PC-Reserve_System</a><br>
						 緑のclone or downloadというボタンを押すとPCのHD上に開発データをDLできます。Binというフォルダの中にエクセルファイルが入っています。バグ報告、プルリクエストなどしていただいてもちろんかまいませんので使える人はそちらからどうぞ。（11/6追記ここまで）<br>
						予約表を操作しているとエラーにであうことがあると思います。その時の対処法を書いていきます。エラーには2種類あります。１つ目は予約表固有エラー、２つ目はVBAエラーです。
					 </p>
				</li>
				<li class="item">
					<h3>予約表固有エラー(9/22追記)</h3>
					<p>マクロ作成者がすでにエラーを認識、原因を解明しているため、エラーが発生した際にメッセージボックスにエラー番号が記載されています。以下に各エラー番号ごとの対処法がありますで、これを参考に対処してください。</p>
					<ul>
						<li>
							:エラー002(9/22追記)
							<p>予約表ファイルはマクロで自動的に保護されるようになっています。それによりセルの背景色を変更する際に、変更できずにエラーが出ることがあります。特に初めてのPCで開いた際に起こりますが一度設定すると発生しなくなります。<br>
								解決策　校閲のシートの保護の解除をクリック</p>
							<img src="image/error_1.png" alt="エラー002＿1">
							<p>シートの保護に変わるのでもう一度クリック</p>
							<img src="image/error_2.png" alt="エラー002＿2">
							<p>セルの書式設定のチェックボックスにチェックを入れてOKボタンを押します。</p>
							<img src="image/error_3.png" alt="エラー002＿3">
						</li>
						<li>
							:エラー番号101(9/22追記)
							<p>通常起こりえないエラーです。原因としてはきちんと生データがソートされていない、ソートされていない状態で予約などを行なったために予約データが重複していると考えられます。まずはLAコントロールパネルで生データをソートしてください。それでもエラーが出る場合は、生データシートを直接見て、同じ時間帯、席番号が被っているデータを削除してください。</p>
						</li>
						<li>
							：エラー番号102(9/22追記)
							<p>予約を削除する際にその人の1日の予約数を減少させようとしたら、その人の学籍番号が見つからなかった場合のエラーです。原因としては重複チェックシートや生データを直接編集した際に起こると思います。特に影響はないですが、LAコントロールパネルで重複チェックシートリフレッシュを行うとよいと思います。</p>
						</li>
						<li>
							：エラー番号103(9/22追記)
							<p>予約を削除する際に生データを検索したら予約が見つからなかった場合です。通常ありえません。生データシートの予約コードが何らかの要因で直接編集された、あるいは予約表の数式が変更されたことも考えられます。バックアップの予約表の数式をコピーして貼り付けるなどしてください。</p>
						</li>
						<li>
							：エラー番号２０１（10/29追記）
							<p>シフト表に読み込まれている番号が出力シートのプロフィールシートに存在しない場合のエラーです。エラーが出た場合はその番号のプロフィール表示をスキップし、モジュール１のshift_profile_countで指定した数までプロフィールの表示を続けます。<br>
								<img src="image/error_4.png" alt="エラー201_1"><br>
								例）その時のシフトが３、１０、１５番号で１０番のプロフィールがなかった場合、３と１５番のプロフィールを表示します。<br>
								また、更新のたびにエラーを吐きますので、プロフィール番号が間違えた場合などはそこを修正。そもそもプロフィールを用意していない場合などはシフト表の番号を０に設定しましょう。０はエラーなしで表示をスキップします。<br>
								例）シフトを３、０、１５に設定するとエラーなしで３と１５番のプロフィールを表示します。</p>
						</li>
					</ul>
				</li>
				<li class="item">
					<h3>VBAエラー(9/22追記)</h3>
					<p>作成者が予期していない、あるいは予期していても防ぐことが難しい場合は発生します。こんな感じのが出てきます。<br>
					<img src="image/vbaerror.png" alt="VBAエラー"><br>
					終了を押して大概問題ありませんが、出来ればデバックボタンを押して、どの行でエラーが出たかスクショして報告してくれると開発に役立ちます。</p>
				</li>
				<li class="item">
					<h3>予約表に予約済と表示されない,予約表の背景色が設定されない,時計が更新されない,VBAエラーが表示されてしまう</h3>
					<p>LAコントロールパネルをガチャ押しで対処できます。あるいはエクセルファイルを立ち上げなおしてください。それでも解決しない場合は新しいファイルを作成してください。この時、エラーの原因が生データやシフト表などのデータを削除してください。</p>
				</li>
				<li class="item">
					<h3>マクロが起動しない(9/22追記)</h3>
					<p>マクロが無効になっているかもしれません。グーグル先生に「マクロ　有効にする」でググりましょう。<br>
					デバックモードになっている可能性があります。・VisualBasicの開き方を参照にvisualBasicを開きます。中断と出ている場合でバックモードです。三角ボタンを押すとマクロが起動するようになります。<br>
					<img src="image/not_up_macro.png" alt="マクロが起動しない">
					途中でデバックモードを挟むと再計算が定期的に実行されなくなる場合があります。表に色がつかないなどの不具合があった場合はLAコントロールパネルの定期再計算再実行ボタンを押してください。</p>
				</li>
			</ul>
		</li>

		<li class="content">
			<h2>開発を進める上での基本的な仕様(9/22追記)</h2>
			<p>
				(9/26追記)このエクセルマクロ作った人間は今までプログラミングのプの字もやったことなかった人間が手探りで作ったものです。そのため、変数は全然リーダブルじゃないし、全体的に処理が冗長です。お願いなのでスマートな処理に直してください。<br>
				開発自体は途中からGitHubをつかってやってるので、GitHubのほうから編集していただくとスマートかと思います。GitHubいまいちよくわかってないので使い方を教えてください。<span class="line">現時点だとちょっといろいろ問題あってGitHubをオープンにできないのでしばしお待ちください。</span>(9/26追記ここまで)<br>
				<span class="line">(10/14追記)GitHubのプライベートリポジトリでも共有できそうなので、GitHubからプルリクできる人は招待するので教えてください。(10/14追記ここまで)</span><br>
				(11/6　追記）オープンレポジトリにしたので自由に更新できます。URL　<a href="https://github.com/Yu0727Harada/PC-Reserve_System">https://github.com/Yu0727Harada/PC-Reserve_System</a>（11/6 追記ここまで）</p>
			<ul>
				<li>
					全体の概要
					<p>9/22 に大幅改修しました。以下を参考にしてください。前の表は削除しました。<br>
						<img src="image/entire_gragh.png" alt="全体の概要">
					</p>
				</li>
				<li>
					メインシートの表のセル内の式(9/22追記)
					<p><span class="line">=IF(-1=IFERROR(VLOOKUP(予約コード参照!C4,生データ!$D$2:$F$9809,3,FALSE),-1),"",IF(ISNUMBER(IFERROR(VLOOKUP(予約コード参照!C4,生データ!$D$2:$F$9809,3,FALSE),-1)),"予約済",VLOOKUP(予約コード参照!C4,生データ!$D$2:$F$9809,3,FALSE))&IF(0=IFERROR(VLOOKUP(予約コード参照!C4,生データ!$D$2:$F$9809,2,FALSE),-1),"","(貸出中)"))</span><br>
						9/22 変更しました<br>
						<span class="line">=IF(ISNUMBER(IF(INDEX(生データ!$D:$D,MATCH(D22,生データ!$D:$D,1))=D22,VLOOKUP(D22,生データ!$D:$F,3,TRUE),)),"予約済"&IF(VLOOKUP(D22,生データ!$D:$F,2,TRUE)=1,CHAR(10)&"(貸出中)",""),IF(INDEX(生データ!$D:$D,MATCH(D22,生データ!$D:$D,1))=D22,VLOOKUP(D22,生データ!$D:$F,3,TRUE),""))</span><br>
						Vlookupは重くなるのでindex&matchの二分探索に切り替えました。CHAR(10)は改行。基本構造は上と同じです。<br>
						（9/29追記）D22セル周辺には予約コードが非表示で置いてあります。<br>
						前から三つ目のif文の説明です。Index＋match関数で一致する予約コードがあるか確認します。Trueの場合はVLOOKUP関数のTrueで二分探索を行います。Falseの場合の処理はなし。<br>
						上のif文の結果、IsNumber関数にはVLOOKUPした学籍番号が入ります。そのため、If文のTrueの場合（IsNumberがTrueの時＝きちんと学籍番号が入っていた場合）予約済と表示し、かつ（＆で文字列の連結）VLOOKUPでケーブルの貸し出しの有無を探索して、１だったら改行コードCHAR(10)を挟んで貸し出し中と表示、１でないなら何もなし。<br>
						If文がFalseの場合（学籍番号ではなく文字列が入っていた場合）もう一度Index＋Matchで探索し（なぜか必要）、一致したらVLOOKUPの出てきた値をそのまま表示、一致しなかった場合は“”を出力。（この処理は文字列を生データに入力するとその文字列が表に表示されるという使用を実装するために入れています）（9/29追記ここまで）<br>
						(11/8　追記)さらに変更しました。マクロに記述してある、時間帯に応じて文字列を返すGet_view_string関数を用いることで時間帯に応じて「予約済」、「使用中」、「使用済」を表示することができます。<br>
						=IF(ISNUMBER(IF(INDEX(生データ!$D:$D,MATCH(D22,生データ!$D:$D,1))=D22,VLOOKUP(D22,生データ!$D:$F,3,TRUE),)),get_view_string(COLUMN(C4)-2)&IF(VLOOKUP(D22,生データ!$D:$F,2,TRUE)=1,CHAR(10)&"(貸出中)",""),IF(INDEX(生データ!$D:$D,MATCH(D22,生データ!$D:$D,1))=D22,VLOOKUP(D22,生データ!$D:$F,3,TRUE),""))<br>
						(11/8　追記ここまで)<br></p>
				</li>
				<li>
					vbac.wsfファイルの使い方(9/26追記)
					<p><a href="http://igeta-diary.blogspot.com/2014/03/what-is-vbac.html">http://igeta-diary.blogspot.com/2014/03/what-is-vbac.html</a>を参考にしてください。コマンドプロンプトでエクセルファイルのある親フォルダに移動してcscript vbac.wsf decombine　をするとエクセルのマクロをテキスト化してくれます。</p>
				</li>
			</ul>
		</li>
	</ol>

</body>
</html>
