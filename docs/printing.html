<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" >
        <title>index</title>
        <link rel="stylesheet" type="text/css" href="index.css">
        <script>
            (function(d) {
                var config = {
                        kitId: 'uda0ekj',
                        scriptTimeout: 3000,
                        async: true
                    },
                    h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
            })(document);
        </script>
    </head>
    <body>
        <a href="https://github.com/Yu0727Harada/xlAres">githubのURL</a>　
        <h1>xlAres　使い方</h1>
        <div class="index">
            <h2>目次</h2>
            <ol>
                <li>
                    <a href="#initialize">使用する前にすること</a>
                </li>
                <li>
                    <a href="#primary">予約を取るための基本的な使い方</a>
                    <ul>
                        <li><a href="#primary/new_reserve">新規予約</a></li>
                        <li><a href="#primary/change_reserve">既存予約の変更</a></li>
                        <li><a href="#primary/change_date">メインページの表示する日付の変更</a></li>
                    </ul>
                </li>
                <li><a href="#administer">LAとしての運営のための基本的な使い方</a>
                    <ul>
                        <li><a href="#administer/edit_raw_data">生データを編集する</a></li>
                        <li><a href="#administer/confirm_status">現在の予約状況を確認（各予約の人数を確認する）</a></li>
                        <li><a href="#administer/set_profile">LAのプロフィールを設定する</a></li>
                        <li><a href="#administer/import_shift">シフトを読み込む</a></li>
                    </ul>
                </li>
                <li><a href="#control_panel">LAコントロールパネル</a>
                    <ul>
                        <li><a href="#control_panel/view">LAコントロールパネルの表示の仕方</a></li>
                        <li>
                            <a href="#control_panel/bottom">コントロールパネルの個々のボタンの説明</a>
                            <ul>
                                <li><a href="#control_panel/bottom/view_option">表示／非表示オプション</a></li>
                                <li>
                                    <a href="#control_panel/bottom/execute">マクロ実行ボタン</a>
                                    <ul>
                                        <li><a href="#control_panel/bottom/execute/data_sort">生データソート</a></li>
                                        <li><a href="#control_panel/bottom/execute/shift_sort">シフトシートソート</a></li>
                                        <li><a href="#control_panel/bottom/execute/repeat_execute">マクロ再実行</a></li>
                                        <li><a href="#control_panel/bottom/execute/recalculate">ワークシート再計算</a></li>
                                        <li><a href="#control_panel/bottom/execute/refresh_duplicate">重複チェックシートリフレッシュ</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#control_panel/bottom/switch_mode">入力モード切り替え</a>
                                    <ul>
                                        <li><a href="#control_panel/bottom/switch_mode/master">マスター入力モード</a></li>
                                        <li><a href="#control_panel/bottom/switch_mode/cursor">選択カーソル強制移動</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#control_panel/bottom/shift_number">勤務中のシフト番号</a>
                                    <ul>
                                        <li><a href="#control_panel/bottom/shift_number/add">シフト追加</a></li>
                                        <li><a href="#control_panel/bottom/shift_number/edit">シフト編集</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#control_panel/bottom/restrict">予約制限</a>
                                    <ul>
                                        <li><a href="#control_panel/bottom/restrict/limit_a_day">一日の上限数</a></li>
                                        <li><a href="#control_panel/bottom/restrict/restrict_reserve">予約制限</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#control_panel/bottom/develop">開発</a>
                                    <ul>
                                        <li><a href="#control_panel/bottom/develop/open_editor">VBEを開く</a></li>
                                        <li><a href="#control_panel/bottom/develop/passcord">パスコードの追加/削除</a></li>
                                        <li><a href="#control_panel/bottom/develop/update">エクセルファイルのアップデート</a></li>
                                        <li><a href="#control_panel/bottom/develop/save">定期保存ON/OFF</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#system">システムのカスタマイズ</a>
                    <ul>
                        <li><a href="#system/const_passcord">パスコードの設定</a></li>
                        <li><a href="#system/set_main">メインシートの各セルの位置を変更する</a></li>
                        <li><a href="#system/set_shift">シフト表の各セルの位置を変更する</a></li>
                        <li><a href="#system/set_profile">プロフィールのテキストボックスなどのカスタマイズをする</a></li>
                        <li><a href="#system/set_profile_details">LAプロフィールユーザーフォームの設定</a></li>
                    </ul>
                </li>
                <li><a href="#make_shift">シフトの作成</a>
                    <ul>
                        <li><a href="#make_shift/input_date">日付の入力</a></li>
                        <li><a href="#make_shift/reset">シフト表リセットボタン</a></li>
                        <li><a href="#make_shift/get_time">シフト時間帯取得</a></li>
                        <li><a href="#make_shift/color">セルの色設定</a></li>
                    </ul>
                </li>
                <li><a href="#error">エラー処理＆困った時の処理リスト</a>
                    <ul>
                        <li><a href="#error/outline">バグの報告</a></li>
                        <li><a href="#error/known">予約表固有エラー</a></li>
                        <li><a href="#error/unknown">VBAエラー</a></li>
                        <li><a href="#error/work">予約表に予約済と表示されない,予約表の背景色が設定されない,時計が更新されない</a></li>
                    </ul>
                </li>
                <li><a href="#implementation">開発を進める上での基本的な仕様</a>
                    <ul>
                        <li><a href="#implementation/outline">全体の概要</a></li>
                        <li><a href="#implementation/cell_formula">メインシートの表のセル内の式</a></li>
                        <li><a href="#implementation/export_macro">vbac.wsfファイルの使い方</a></li>
                    </ul>
                </li>
            </ol>
        </div>

        <ol class="main-contents">
            <li id="initialize" class="content">
                <h2>使用する前にすること</h2>
                <p>このエクセルファイルを運用する前に、準備することがあります。この準備の目的は第三者にこのエクセルファイルを操作させた際に、アクセスされたくないデータにアクセスされたり、内容を改ざんされることを防ぐ目的と、見た目をよくする目的があります。</p>
                <ol>
                    <li>
                        <a href="#control_panel/bottom/execute/repeat_execute">LAコントロールパネルのマクロ再実行</a>を押します。これはなぜかエクセルファイルを開いた直後にはマクロが実行されないからです。もしそれでもなお動かない場合はシートを数回切り替えてください。<br>
                    </li>
                    <li>
                        必要であれば表示倍率を調節してください。
                    </li>
                    <li>
                        <a href="#control_panel/bottom/view_option">LAコントロールパネルの表示/非表示オプション</a>から、数式バー、行列番号、ステータスバー、シートタブ、リボンを非表示にします。
                    </li>
                    <li>
                        <a href="#control_panel/bottom/view_option">LAコントロールパネルの表示/非表示オプション</a>から、シートの保護を行います。(一般に、すでに保護されているはずですが一応）
                    </li>
                    <li>
                        <a href="#control_panel/bottom/switch_mode/master">LAコントロールパネルのマスター入力モード</a>をoffに、<a href="#control_panel/bottom/switch_mode/cursor">選択カーソル強制移動</a>をOnにします。
                    </li>
                    <li>
                        どこかのセルをクリックするか、スクロールバーを使用してPC席予約表が画面に映るようにします。
                    </li>
                    <li>
                        <a href="#control_panel/view">メインシート左下の歯車をクリック</a>してスクロールバーを消します。<br>
                        これで準備は完了です。
                    </li>
                </ol>
            </li>
            <li id="primary" class="content">
                <h2>予約を取るための基本的な使い方</h2>
                <ul>
                    <li class="item" id="primary/new_reserve">
                        <h3>新規予約</h3>
                        <ol>
                            <li>
                                <h4>エクセルファイルを開きメインシートを開きます。</h4>
                            </li>
                            <li>
                                <h4>予約したい時間帯、席番号のセルを選択する</h4>
                                <img class="img_max" src="document/image/1-1.png" alt="予約の仕方">
                            </li>
                            <li>
                                <h4>予約フォームが表示される。</h4>
                                <p>
                                    テキストボックス5つのうち１つ以上にに学籍番号7桁(M,D,Sを含む番号も入力可能)か、学生証台帳番号16桁の数字を入力してください。もしくはバーコードをスキャンしてください。<br>
                                    <img class="img_small" src="document/image/1-2.png" alt="予約フォーム" ><br>
                                    2コマ使用希望にチェックを入れると2コマ連続で予約を取ることができます。HDMIケーブルなどを貸し出し希望にチェックを入れると予約ステータスが変化します。（後述）<br>
                                </p>
                                <p>
                                    必要事項を入力したら、下の登録ボタンをクリックします。<br>
                                    この時、予約が1日の中で一定数以上に達している場合、予約を取るかどうかの確認ダイアログが出ます。（一日に取れるコマの設定の仕方は<a href="#control_panel/bottom/restrict/limit_a_day">LAコントロールパネルの一日の上限数参照</a><br>
                                    <img class="img_small" src="document/image/1-3.png" alt="予約制限オーバーの時">
                                </p>
                                <p>
                                    いいえをクリックすると予約画面に移動します。<br>
                                    はいをクリックすると、LAを呼んでパスコードを入力するように促されます。（<a href="#control_panel/bottom/develop/passcord">LAコントロールパネル―パスコードの設定</a>、<a href="#system/const_passcord">システムのカスタマイズ、パスコードの設定参照</a><br>
                                    パスコードの入力が正しければ予約され、間違っていれば予約画面に移動します。<br>
                                    <img class="img_small" src="document/image/passcord.png" alt="パスコードを要求される"><br>
                                </p>
                            </li>
                            <li>
                                <h4>メインシートで選択した日時、席番号箇所が予約済と表示されます。</h4>
                                <p>
                                    現在の時間帯の場合は使用中、現在以降の時間帯の場合には予約済、マスタモード（<a href="#control_panel/bottom/switch_mode/master">LAコントロールパネル-マスターモード参照</a>）などで入力した場合などは使用済と表示されます。ケーブル貸し出しにチェックを入れた場合は予約済(貸出中)と表示されます。（11/8　追記ここまで）
                                </p>
                            </li>
                        </ol>
                    </li>>

                    <li class="item" id="primary/change_reserve">
                        <h3>既存予約の変更</h3>
                        <p>
                            予約済か、使用中と表示されているセルをクリックすると予約の変更などフォームが表示されます。マスターモードの場合は使用済のセルをクリックしても表示されます。（<a href="#control_panel/bottom/switch_mode/master">マスターモードについて参照する</a>）<br>
                            <img class="img_small" src="document/image/vary_resrve.png" alt="予約変更フォーム"><br>
                        </p>
                            <ul>
                                <li>
                                    利用者の追加をクリックすると利用者の追加フォームが表示され、新規予約同様に番号を入力することで、予約者の追加を行うことが出来ます。<br>
                                    <img class="img_small" src="document/image/add_user.png" alt="利用者の追加"><br>
                                </li>
                                <li>
                                    延長をクリックすると、1コマ分延長することが出来ます。<br>
                                </li>
                                <li>
                                    予約の取り消しを押すと取り消しフォームが出ます。<br>
                                    <img class="img_small" src="document/image/delete_resrve.png" alt="予約の取り消し">
                                    <p>
                                        LAのパスコードを入力するか、取り消したい予約を行なった人、誰か一人の学籍番号か台帳番号を入力することで予約を取り消すことが出来ます。（<a href="#control_panel/bottom/develop/passcord">LAコントロールパネル―パスコードの設定</a>、<a href="#system/const_passcord">システムのカスタマイズ、パスコードの設定参照</a>）<br>
                                        <span class="red">この時、正しく入力していても取り消せない場合があります。</span>これは学籍番号を台帳番号に変換する際に不具合があるからです。具体的には下の画像の黄色の学科の台帳番号は実際にそうであるか不明で仮での変換です。そのため、変換がうまくいかず、取り消しの認証がされません。もしそのような人がいた場合はパスコードを入力して対処してください。<br>
                                        また、できれば正確な台帳番号が手に入れば更新してください。（更新の仕方→<a href="#implementation/outline">GitHubで報告していただければ対応します</a>）<br>
                                        <img class="img_small" src="document/image/student_number_list.png" alt="変換表">
                                    </p>
                                </li>
                                <li>
                                    ケーブル貸し出しボタンをクリックすると、貸し出しのステータスが変化します。
                                </li>
                            </ul>
                    </li>

                    <li class="item" id="primary/change_date">
                        <h3>メインページの表示する日付の変更</h3>
                        <img class="img_small" src="document/image/vary_time.png" alt="日付の変更">
                        <p>	表示されている予約表はK2セルに入力されている日付に従って表示しています。通常はセルの中身は「=today()」としていますが「=today()-1」とすることで昨日の予約表を表示したり、「8/1」などと入力することで、過去や未来の日付の予約表を表示し、その日付の予約をすることが出来ます。<br>
                        過去の日付を表示した場合は予約はできませんが、未来の日付を表示した場合は全ての時間帯で予約できます。<a href="#control_panel/bottom/switch_mode/master">LAコントロールパネル-マスターモード</a>を用いることで過去の予約の編集も可能となります<br>
                        日付を変更した場合、すぐに予約表が更新されないので<a href="#control_panel/bottom/execute/repeat_execute">LAコントロールパネルの定期再計算再実行ボタン</a>を2回ほど実行してください。</p>
                    </li>
                </ul>
            </li> 
            <li class="content" id="administer">
                <h2>LAとしての運営のための基本的な使い方</h2>
                <ul>
                    <li class="item" id="administer/edit_raw_data">
                        <h3>生データを編集する</h3>
                        <p>予約をした際に、データは全て生データシートに格納されます。</p>
                        <img class="img_small" src="document/image/raw_data.png" alt="生データ">
                        <p>
                            A列の予約日はyyyymmdd形式で予約した日付、B列の予約時間帯は予約したコマが入力されます。（1→1限目、2→2限目、3→昼休み、4→3限目、5→4限目というように対応しています）<br>
                            C列の席番号は予約したPC席の番号、D列の予約コードは日付と予約時間帯、席番号を合わせた、データ処理用のコード番号を、E列はケーブルを貸し出しているかどうか、1は貸し出し中、0は貸し出していない場合を表示します。F列からは入力された台帳番号を省略した<span class="red">独自の番号</span>を表示しています。（フォームから学籍番号を入力すると自動的に変換されます）<br>
                            直接ここに入力することで予約を編集することも可能です。<br>
                            また学籍番号を入力するセルに文字列を入力するとその入力した文字列が表示されます。機材の不調や貸切など、特殊なステータスが必要な場合に利用することが出来ます。（表からの予約も不可になります）<span class="red">逆に言うとここにMとかDを含む学籍番号を入れるとそれがそのまま表示されてしまうので入力する場合は台帳番号を入力するか、他の数字に置き換えて入力してください。メインシートの右のほうには変換表もあるので参照してください</span><br>
                            <img class="img_small" src="document/image/paticular_resrve.png" alt="特殊ステータス表示">
                            <img class="img_small" src="document/image/paticular_status_data.png" alt="特殊ステータス表示生データ"><br>
                            <span class="red">直接入力した場合は<a href="#control_panel/bottom/execute/data_sort">シートソートボタン</a>をクリックするか、予約コードをキーとして昇順で並び替えを行ってください。（match関数の近似値一致で検索するため。軽量化のために行ったため、今後変更の予定は現状ありません）</span>
                        </p>
                    </li>

                    <li class="item" id="administer/confirm_status">
                        <h3>現在の予約状況を確認（各予約の人数を確認する）</h3>
                        <p>
                            予約の人数を確認するために、LAコントロールパネルの右側に予約している学生の台帳番号を元にした独自番号がすべて表示される表をつくりました。<br>
                            <img class="img_small" src="document/image/observe_resrve.png" alt="予約状況の確認"><br>
                            現在表示している時間帯コードの右のセルにマクロで現在の時刻を表す数値が入ります。（マクロではpublic変数のon_timeのことです）１は１限目、で一つコマが進むごとにずれていき（時刻とともに自動で更新されます）、８は閉室後以降（表外）を表します。この表はこのセルに入っている時刻での予約状況を示しています。表示している時間帯のセルを直接編集することで自由に時間帯の予約状況を確認することもできます。<br>
                            （開発用　セルの中の式） =IFERROR(IF(INDEX(生データ!$D:$D,MATCH(OFFSET($D$22,$Z4-1,$AA$3-2),生データ!$D:$D,1))=OFFSET($D$22,$Z4-1,$AA$3-2),VLOOKUP(OFFSET($D$22,$Z4-1,$AA$3-1),生データ!$D:$O,COLUMN(C1),TRUE),""),0)<br>
                            メインシートのD22周辺に予約コードを生成して出力しておく場所があります。それをmatch＋index関数で参照しますが、今回は時間帯セルに合わせてD22セルから移動して参照してほしいのでoffset関数を用いて、D22セルから移動させます。<br>
                            Match＋index関数で参照した先が一致した場合（if文Trueの場合）はVLOOKUPの二分探索（True）で生データシートを探索に行きます。この時、列の位置はColumn関数で指定することで右側にコピペしたときに順に参照位置がずれるようにします。一致しなかった場合は“”を吐くように設定。<br>
                            Iferrorは時間帯セルに８が来たときにN/Aエラーを吐くのでそれを防止するため。
                        </p>
                    </li>
                    <li class="item" id="administer/set_profile">
                        <h3>LAのプロフィールを設定する</h3>

                            メインシートの右側に表示しているLAのプロフィールを変更したい時は入力シートに入力して出力ボタンを押すことで新しくプロフィールを出力出来ます。<br>
                            <img class="img_small" src="document/image/input_profile.png" alt="入力シート"><br>
                            入力シートA列に入力した番号が出力シートのA列に入力されます。なお、ボタンを押して出力すると自動的にA列でソートされます。このA列に入力した番号とシフト表の番号に対応させてメインシートに出力するため、個人の番号を一致させるようにしてください。この番号は0以上の整数にしてください。また0については特殊な動作をします。後述の<a href="#administer/set_profile">番号が0のプロフィールについての特殊動作</a>について参照してください。<br>
                            B列、C列、D列に書いた内容は１つのテキストボックスでまとめて出力されます。<br>
                            E列を選択するとファイル選択ダイアログが出てくるので、表示させたい画像を選択してください。この時、このプロフィール画像はPC予約表エクセルファイルと同一か、それ以下のフォルダに置くようにしてください。また、E列に何も入力せず出力ボタンを押した場合、PC予約表エクセルファイルと同一フォルダに置かれている"Noimage.png"ファイルの画像が出力されるようになっています。<br>
                            <img class="img_small" src="document/image/folder-note.jpg" alt="フォルダ階層模式図"><br>
                            出力ボタンを押すと自動でトリミングなど行います。この時の設定は<a href="#system/set_profile">システムのカスタマイズ</a>から行えます。<br>
                            F列に入力された文字はプロフィール下部に表示されます<br>
                            <img class="img_small" src="document/image/profile.png" alt="プロフィール出力"><br>
                            出力シートを見るとこのように出力されます。出力シートの枠線を表示するとメインシートに出力した時にも枠線が見えるようになります。出力シートを直接編集してもメインシートでの表示に反映されます。出力ボタンを押した時の出力の位置を変えたい場合には<a href="#system/set_profile">プロフィールのテキストボックスなどのカスタマイズをする</a>を参照してください。

                            <h4>番号が0のプロフィールについての特殊動作</h4>
                            番号が０のプロフィールは特殊な扱いを受けます。例えば、シフト表に０の番号が入力されていた場合はそのプロフィールの表示をスキップします。つまり、シフト表に0番号があってもプロフィールの表示はされません。<br>
                            では、いつ表示されるかというと番号が０のプロフィールが表示されるのは現在の時間帯に勤務している人が誰もいない時です。（≒シフト表に現在の時間帯の入力がない場合）誰も勤務している人がいないときに表示させたいメッセージなどを設定したりすることが可能です。<br>
                            番号0のプロフィールは入力シートで入力した時にも特別な動作をします。0の番号のプロフィールを入力した時には出力シートの0プロフィールを削除し、新たに入力されたプロフィールを出力します。一方、0プロフィールを入力しなかった時は出力シートの0プロフィールは削除されず、他のプロフィールのみ削除し出力シートを更新します。<br>
                            <img class="img_small" src="document/image/zero_profile_1.png" alt="プロフィール番号0-1">
                            <img class="img_small" src="document/image/zero_profile_2.png" alt="プロフィール番号0-2"><br>
                            LAが勤務していない時に表示させておきたい文言などを登録しておくと便利だと思います。（出力シートは直接編集することも出来ますので自由に出力することが出来ます。<br>

                    </li>
                    <li class="item" id="administer/import_shift">
                        <h3>シフトを読み込む</h3>

                            別ファイルで作成したシフト表を読み込むことで、メインシートにプロフィールを表示することができます。<br>
                            <ol>
                                <li>
                                    シフト表シートを選択します。<br>
                                    <img class="img_small" src="document/image/shift_1.png" alt="シフト読み込み1"><br>
                                </li>
                                <li>
                                    A列には勤務時間の開始時刻、B列には終了時刻、C列にはシフト表の入力時の番号が入力されています。<br>
                                    <img class="img_small" src="document/image/shift_2.png" alt="シフト読み込み2">
                                </li>
                                <li>
                                    シフト読み込みボタンを押すとファイル選択ダイアログが出ます。読み込みたいシフト表のファイルを選択します。<br>
                                    <img class="img_small" src="document/image/shift_3.png" alt="シフト読み込み3">
                                </li>
                                <li>
                                    この時、すでに読み込んだ期間のシフトの場合は読み込むかどうかの許可を求めるダイアログが出ます。キャンセルを押すと処理を終わります。OKを押すとすでに入力されている日のシフトを上書きしてシフトを読み込みます。<br>
                                    <img class="img_small" src="document/image/shift_4.png" alt="シフト読み込み4">
                                </li>
                                <li>
                                    シフトの読み込みは勤務時間終了時間をキーに昇順並び替えで読み込んでいます。手で訂正した場合は並び替えを行なってください。<br>
                                </li>
                            </ol>

                    </li>
                </ul>
            </li>
            <li class="content" id="control_panel">
                <h2>LAコントロールパネル</h2>
                <ol>
                    <li id="control_panel/view" class="item">
                        <h3>LAコントロールパネルの表示の仕方</h3>
                        <p>
                            メインシートの右側にLAコントロールパネルがあります。これを操作するためにはスクロールバーが必要です。<br>
                            スクロールバーが表示されていない場合は予約表の右下にある歯車ボタンをクリックするとパスコードを要求されます。<br>
                            <img class="img_small" src="document/image/geer.png" alt="歯車ボタン"><br>
                            パスコードの入力が完了するとスクロールバーが表示されます。（既に表示されていた場合には非表示になるます。）スクロールバーを操作して予約表の右側のコントロールパネルを表示させます。<br>
                            <img class="img_small" src="document/image/compane_outline.png" alt="コントロールパネル">
                        </p>
                    </li>
                    <li id="control_panel/bottom" class="item">
                        <h3 >コントロールパネルの個々のボタンの説明</h3>
                        <ul>
                            <li id="control_panel/bottom/view_option">
                                <h4 >表示／非表示オプション</h4>
                                エクセルの外見について操作することができます。利用者に意図しない操作をさせないためにも、基本的に全ての項目を非表示にし、シートを保護した状態にしてください。
                            </li>
                            <li id="control_panel/bottom/execute">
                                <h4 >マクロ実行ボタン</h4>
                                <ul>
                                    <li id="control_panel/bottom/execute/data_sort">
                                        <h5 >生データソート</h5>
                                        <p>
                                            生データシートに入力されているデータを予約コードをキーにして昇順でソートします。<br>
                                            こんな時に→予約ずみと表に表示されない時
                                        </p>
                                    </li>
                                    <li id="control_panel/bottom/execute/shift_sort">
                                        <h5 >シフトシートソート</h5>
                                        <p>
                                            シフト表シートを勤務終了時刻をキーとして昇順にソートします。シフトが意図した通りに読み込まれない場合などに用いてください。
                                        </p>
                                    </li>
                                    <li id="control_panel/bottom/execute/repeat_execute">
                                        <h5 >マクロ再実行</h5>
                                        <p>
                                            メインシートは1分ごとに再計算を行なっていますが、たまに止まります。（エラーが出た時、マクロの編集をした時など）時刻の更新が一定時間（2分以上）されない場合はシートの再計算が実行されてないので、このボタンを押してください。<br>
                                            こんな時に→日付を変更した場合,予約済と出るのに表に色がつかない現象が恒常的に起こる。 時刻が更新されない、あるいは表示されている時刻が0:00などおかしい<br>
                                            その他大概の不具合がこれで治ると思います。治らなかったらエクセルを再起動してください
                                        </p>
                                    </li>
                                    <li id="control_panel/bottom/execute/recalculate">
                                        <h5 >ワークシート再計算</h5>
                                        <p>
                                            メインシートの再計算を行います。<br>
                                            こんな時に→予約をしたのに表に予約ずみと表示されない時、時刻が更新されない時
                                        </p>
                                    </li>
                                    <li id="control_panel/bottom/execute/refresh_duplicate">
                                        <h5>重複チェックシートリフレッシュ</h5>
                                        <p>
                                            予約している人のそれぞれのその日の予約数を記録している重複チェックシートを一度クリアして、新たに人数を数え直します。<br>
                                            こんな時に→エラー処理でこれをするように指示された時。予約数絡みでなんかおかしいとき。
                                        </p>
                                    </li>
                                </ul>
                            </li>
                            <li id="control_panel/bottom/switch_mode">
                                <h4 >入力モード切り替え</h4>
                                <ul>
                                    <li id="control_panel/bottom/switch_mode/master">
                                        <h5 >マスター入力モード</h5>
                                        <p>当日の過ぎた時間帯でも予約・予約の変更取り消しなどができるようになります。パスコードの入力が必要です<br>
                                            こんな時に→入力データを修正したい、過去のデータを入力したい</p>
                                    </li>
                                    <li id="control_panel/bottom/switch_mode/cursor">
                                        <h5 >選択カーソル強制移動</h5>
                                        <p>選択カーソルを強制的に移動するように設定できます。運用の際にはonにすることで、繰り返し同じセルをクリックすることが可能になります。パスコードの入力が必要です。編集作業などをする際には邪魔になるのでオフにすると便利です。</p>
                                    </li>
                                </ul>
                            </li>
                            <li id="control_panel/bottom/shift_number">
                                <h4 >勤務中のシフト番号</h4>
                                <p>
                                    勤務中のLAの番号を表示します。この番号を参照してプロフィールを表示しています。<br>
                                    基本的にここに表示される番号は５つまでです。表示するプロフィールの数は別途設定できます。<a href="#system/set_profile">３．システムのカスタマイズのメインシートの各セルの位置を変更するを参照</a>してください。<Br>
                                    プロフィール表示の細かい仕様は<a href="#administer/set_profile">プロフィール表示設定</a>を参照してください。
                                </p>
                                <ul>
                                    <li id="control_panel/bottom/shift_number/add">
                                        <h5 >シフト追加</h5>
                                        <p>
                                            新しく現在の時刻から勤務する人を追加することができます。<br>
                                            <img class="img_small" src="document/image/add_shift.png" alt="シフトの追加"><br>
                                            勤務する人、勤務する時間を選択し登録ボタンを押すと、現在の時刻から選択した時間までのシフトが追加されます。この時、時間の選択は任意です。選択しなかった場合自動的に2時間となります。<br>
                                            登録したあとすぐにシフト番号が表に表示されないことがあります。その時は<a href="#control_panel/bottom/execute/repeat_execute">マクロ再実行ボタン</a>を押してください。
                                        </p>
                                    </li>
                                    <li id="control_panel/bottom/shift_number/edit">
                                        <h5 >シフト編集</h5>
                                        <p>
                                            現在勤務しているシフトを削除、勤務終了時刻を現在の時刻に設定することができます。
                                        </p>
                                    </li>
                                </ul>
                            </li>
                            <li id="control_panel/bottom/restrict">
                                <h4 >予約制限</h4>
                                <ul>
                                    <li id="control_panel/bottom/restrict/limit_a_day">
                                        <h5 >一日の上限数</h5>
                                        <p>
                                            左のセルの数字を変更することで一日の予約可能数を変更することができます。文字列を入力すると36と認識され、「予約制限はありません」と表示されます。
                                        </p>
                                    </li>
                                    <li id="control_panel/bottom/restrict/restrict_reserve">
                                        <h5 >予約制限</h5>
                                        <p>
                                            左のオンオフの切り替えを行うことで予約の制限を行うことができます。オンにすると現在のコマのみ予約可能となり、先のコマの予約ができなくなります。（すでに予約されているコマは編集可能）<br>
                                            またオンにすると予約の仕方に予約制限中である旨が表示されます<br>
                                            オンにしてるときに先のコマを予約しようとすると、予約制限中であることを知らせるウィンドウを出すようにしました。また、延長、２コマ連続予約にも制限がかかるようにしました。
                                        </p>
                                    </li>
                                </ul>
                            </li>
                            <li id="control_panel/bottom/develop">
                                <h4 >開発</h4>
                                <ul>
                                    <li id="control_panel/bottom/develop/open_editor">
                                        <h5 >VBEを開く</h5>
                                        <p>
                                            マクロの編集を直接できるVisualBasicEditorを開くことができます。<a href="#system">システムのカスタマイズ</a>で<a href="#system/const_passcord">パスコードを設定</a>したり、<a href="#system/set_profile">プロフィールのデザインを設定</a>したりできます。
                                        </p>
                                    </li>
                                    <li id="control_panel/bottom/develop/passcord">
                                        <h5 >パスコードの追加/削除</h5>
                                            現在PC予約表でパスコードには2種類あります。１つ目は<a href="#system/const_passcord">VBE上の標準モジュールにて"passcord"という定数として設定</a>されているもの。便宜上、これを定数パスコードと名付けます。２つ目は登録した人の学籍番号、あるいは学生証に表記されている台帳番号をパスコードとして利用できます。このボタンからその登録を行うことができます。学籍番号と台帳番号は共通の独自の番号に変換されるので、どちらかを登録すると入力画面では両方の入力に対応します。<br>
                                            <ol>
                                                <li>
                                                    ボタンを押すとパスコードを要求されます。これは第三者から自由にパスコードを追加されたりしないようにするためです。定数パスコードかすでに登録した人の学籍番号などを入力してください。
                                                </li>
                                                <li>
                                                    登録する人の学籍番号か台帳番号を入力し、OKボタンを押すと、新規のパスコードを登録することができます。<br>
                                                    すでに登録した人の学籍番号か台帳番号を入力すると、その番号を削除することができます。
                                                </li>
                                            </ol>
                                            パスコードとして登録した番号のリストは直接見ることは出来ません。個人情報保護の観点から誰でも閲覧できるのはまずいかと思ったので隠しています。
                                    </li>
                                    <li id="control_panel/bottom/develop/update">
                                        <h5 >エクセルファイルのアップデート</h5>

                                            PC予約表のマクロはオンラインストレージであるgithub上で更新されています。githubでの操作を含めてアップデートの仕方を説明します。
                                        <ol>
                                            <li>
                                                githubURL<a href="https://github.com/Yu0727Harada/xlAres">https://github.com/Yu0727Harada/xlAres</a>にアクセスします。<br>
                                                赤丸で記した緑色のclone or downloadを押します。<br>
                                                <img class="img_small" src="document/image/github.png" alt="githubの画面">
                                            </li>
                                            <li>
                                                downloadするためのボタンが出てくるのでdownload Zipをクリックします。<br>
                                                <img class="img_small" src="document/image/github_download.png" alt="githubのdownload"><br>
                                                ダウンロードが始めるので好きな所に保存します。
                                            </li>
                                            <li>
                                                保存した所に移動してダウンロードしたファイルを選択し、右クリックから全てを展開を選択します。<br>
                                                <img class="img_small" src="document/image/zip_file.png" alt="ZIPファイルを展開"><br>
                                                好きな所に展開をします<br>
                                                <img class="img_small" src="document/image/zip_dialog.png" alt="ZIPファイルを展開-2"><br>
                                                展開したフォルダの中にbinという名前のフォルダがあります。色々ファイルが入っていますが、大事なのはこの中に入っているPC席予約表のエクセルファイルとせいぜいnoimage.pngファイルです。noimage.pngファイルについては<a href="#administer/set_profile">LAのプロフィールを設定する</a>を参照してください。<br>
                                                PC席予約表のエクセルファイルを好きな場所に移動します。
                                            </li>
                                            <li>
                                                移行元の予約表エクセルファイルを用意します。この時、移行元と移行先のエクセルファイルの名前は異なるものにしてください。以降元のエクセルファイルを開きます。<br>
                                                <a href="#control_panel/view">LAコントロールパネルを表示</a>し、エクセルファイルのアップデートボタンを押します。ファイルダイアログが出るので先ほどダウンロードしたエクセルファイルを選びます。<br>
                                                選ぶと画面がカチカチしたりしますが、この間にデータの移行を行なっています。データの移行が終わるとダイアログが出ます。<br>
                                                <img class="img_small" src="document/image/excel_update.png" alt="完了ダイアログ"><br>
                                                これでデータの移行は完了です。
                                            </li>
                                        </ol>
                                        このデータの移行で移行できるデータは<a href="#primary/new_reserve">生データシートに保存された予約のデータ</a>、<a href="#administer/set_profile">入力シートに入力したデータ、出力シートのオブジェクト</a>、<a href="#administer/import_shift">シフト表シートに保存されたデータ</a>、<a href="#control_panel/bottom/develop/passcord">パスコードの追加</a>から追加したパスコードです。<br>
                                        このパスコードには定数パスコードは含まれません。定数パスコートを引き継ぐには<a href="#system/const_passcord">VBEエディター</a>から定数パスコードを設定し、<a href="#implementation/outline">github上のデータをアップデート</a>する必要があります。

                                    </li>
                                    <li id="control_panel/bottom/develop/save">
                                        <h5>定期保存のON/OFF</h5>
                                        エクセルのファイルは1分ごとに保存されています。しかし、編集を行なっている時などは保存が入ると重くなってしまいます。そのため、定期的に保存するかどうかをこのボタンで選択することが出来ます。<br>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                        <p class="red">基本的に挙動がおかしい時は、定期再計算再実行とメインシートセッティングと生データソートをガチャ押しすれば治りますので、よく分からない時はガチャ押ししてください。<br>
                            また、エラーによってはこのボタンを押してくださいと出るので、その時に、指定のボタンを押してください。押してリカバリーの効かない操作のボタンはありませんので、押すことをためらう必要はありません。</p>
                    </li>
                </ol>
            </li>
            <li id="system" class="content">
                <h2 >システムのカスタマイズ</h2>
                <ul>
                    <li class="item" id="system/const_passcord">
                        <h3 >定数パスコードの設定</h3>
                        <p>予約表の操作には利用者に操作されては困りそうな操作にはパスコードの入力を求めるようにしています。パスコードについては<a href="#control_panel/bottom/develop/passcord">パスコードの追加／削除</a>も参考にしてください。定数パスコードはマクロを変更することでいつでも変更ができます。</p>
                        <ol>
                            <li>
                                <p>
                                    <a href="#control_panel/bottom/develop/open_editor">VisualBasicEditor</a>を開き、標準モジュールフォルダのModule1を選択します。<br>
                                    <img class="img_small" src="document/image/passcord_1.png" alt="パスコード設定1"><br>
                                    このウィンドウがない場合は表示→プロジェクトエクスプローラーを選択することで表示されます.<br>
                                    <img class="img_small" src="document/image/passcord_2.png" alt="パスコード設定2">
                                </p>
                            </li>
                            <li>
                                <p>
                                    module1が表示されます。<br>
                                    <img class="img_small" src="document/image/passcord_3.png" alt="パスコード設定3"><br>
                                    「Public const passcord as string = 」というのがあります。この＝の次の数字がパスコードです。この数字を変えることでパスコードを変更することができます。<br>
                                </p>
                            </li>
                        </ol>
                    </li>
                    <li class="item" id="system/set_main">
                        <h3 >メインシートの各セルの位置を変更する</h3>
                        <p>
                            パスコードと、モジュールを開くとこまでは同じです。パスコードの下に書いてある文字を変更することで位置を変更することができます。<br>
                            <img class="img_small" src="document/image/design_1.png" alt="位置変更1"><br>
                            各変数の表しているセルの位置を図にしめしてあります。Columnの綴りが間違っている箇所がありますので、誰か直してください。他にもタイポしてたりするのですみません。メインシートのデザインを変更した際などに数字を調整してください。<br>
                            <img class="img_small" src="document/image/design_2.png" alt="位置変更2"><br>
                        </p>
                    </li>
                    <li class="item" id="system/set_shift">
                        <h3 >シフト表の各セルの位置を変更する</h3>
                        <p>
                            別ファイルのシフト表作成ファイルのセルの位置を変更した場合などは3.システムのカスタマイズ-メインシートの各セルの位置を変更するを参照して、以下の数字変更してください。各変数の表すセルの位置は図に示しました。<br>
                            <img class="img_small" src="document/image/design_shift_1.png" alt="シフト位置変更1">
                            <img class="img_small" src="document/image/design_shift_2.png" alt="シフト位置変更2">
                        </p>
                    </li>
                    <li class="item" id="system/set_profile">
                        <h3 >プロフィールのテキストボックスなどのカスタマイズをする</h3>
                        <p>
                            <a href="#control_panel/bottom/develop/open_editor">VisualBasicの開き方を</a>参照してvisualBasicを開きます。Module2を開きます<br>
                            <img class="img_small" src="document/image/design_profile_1.png" alt="プロフィール位置調整1">
                            <img class="img_small" src="document/image/design_profile_2.png" alt="プロフィール位置調整2"><br>
                            Module2の中にテキストボックスを出力するコードがあります。一番上の方にあるT,L,W,Hと書かれているところが名前と所属をテキストボックスの出力をコントロールする部分です。<br>
                            <img class="img_small" src="document/image/design_profile_3.png" alt="プロフィール位置調整3"><br>
                            少し下の行に書かれているT2、L2、W2、H2という変数を先ほどの要領で調整することで、コメント部分の出力位置を変更できます。<br>
                            <img class="img_small" src="document/image/design_profile_4.png" alt="プロフィール位置調整4"><br>
                            さらに下の行には画像の出力位置を調整する変数があります。先ほどの要領でslection.top,selection.left,selection.widthを変更することで出力位置を変更できます。<br>
                            <img class="img_small" src="document/image/design_profile_5.png" alt="プロフィール位置調整5"><br>
                            msoshapeOvalは楕円を指定しています.他の形にも出来ます（ググって）<br>
                            <img class="img_small" src="document/image/design_profile_6.png" alt="プロフィール位置調整6">
                        </p>
                    </li>
                    <li class="item" id="system/set_profile_details">
                        <h3 >LAプロフィールユーザーフォームの設定</h3>

                            LAの詳しいプロフィールを閲覧できるユーザーフォームを設定することができます。<a href="#control_panel/bottom/develop/open_editor">VisualBasicを開き</a>、フォームフォルダのProfileをクリックします。
                            <img class="img_small" src="document/image/design_prfile_tab.png" alt="プロフィールタブ設定"><br>
                            プロフィール画面が表示され、編集することができます。ツールボックスを使用することで画像やテキストを配置することができます。<br>
                            <img class="img_small" src="document/image/design_profile_tab_2.png" alt="プロフィールタブ設定"><br>
                            <img class="img_small" src="document/image/design_profile_tab_3.png" alt="プロフィールタブ設定"><br>

                                ツールボックスの説明です。（使いそうなものの最低限しかしませんので、あとはGoogle先生に聞いてください）<br>
                            <ul>
                                <li>矢印は選択ツールで、オブジェクト（画像とかテキストとか）を選択しプロパティウィンドウ（後述）でオブジェクトのプロパティ（表示するテキストとか、フォントとか画像パスとか）を編集することができます。</li>
                                <li>Aのアイコンは選択するとラベル（ワード的に言えばテキストボックス）をユーザーフォーム上でドラックすることで作成できます。</li>
                                <li>真ん中の行のルーズリーフのインデックスのようなアイコンをクリックしてドラッグすると、タブで選択できるエリアを作成することができます。</li>
                                <li>右下の青い波立ってる的な画像アイコンを選択すると画像エリアをユーザーフォーム上でドラッグすることで作成できます。</li>
                            </ul>

                            上記の通りでラベルエリアや画像エリアを作った後はプロパティウィンドウでフォントやテキスト、画像の貼り付けを行います。プロパティウィンドウは通常プロジェクトウィンドウの下に表示されています。<br>
                            <img class="img_small" src="document/image/proprety_window.png" alt="プロパティウィンドウ"><br>
                            表示されていない場合はメニューバーの表示→プロパティウィンドウで表示できます。<br>
                            <img class="img_small" src="document/image/property_window_2.png" alt="プロパティウィンドウ2"><br>
                            <img class="img_small" src="document/image/property_window_3.png" alt="プロパティウィンドウ3"><br>
                            選択ツールでオブジェクトを選択、プロパティを編集することで色々いじれます。1から10まで解説するのはしませんがある程度直感でいじれます。ある程度書いておきます。<br>
                            <ul>
                                <li>BackColor オブジェクトの背景色を設定します</li>
                                <li>BackStyle 背景の有無の選択。0(transparent)→透明　1(opaque)→BackColorで選択した色を表示</li>
                                <li>BorderColor  オブジェクトの境界線（輪郭線）の色を設定します。</li>
                                <li>BorderStyle 境界線の有無の設定</li>
                                <li>Caption ラベルに表示するテキストの設定します</li>
                                <li>Enabled オブジェクトが実際にエクセルのデータで表示されるかを設定します</li>
                                <li>Font フォントの設定</li>
                                <li>ForeColor 文字の色</li>
                                <li>Height オブジェクトの高さ</li>
                                <li>Left オブジェクトの横の長さ</li>
                                <li>Specialeffect オブジェクトを立体的に見せたりできる</li>
                                <li>TextAlign テキストの中央揃え、左揃えなどの設定</li>
                                <li>Picture 表示する画像をファイルダイアログから選べます</li>
                            </ul>

                    </li>
                </ul>
            </li>
            <li class="content" id="make_shift">
                <h2 >シフトの作成</h2>
                <p>別ファイルのシフト表作成ファイルを用いることでシフトを作成することができます。</p>
                <ul>
                    <li class="item"  id="make_shift/input_date">
                        <h3>日付の入力</h3>
                        <p>作成するシフトの期間を入力します。</p>
                        <img class="img_small" src="document/image/make_shift_1.png" alt="シフト表日付の入力">
                        <p>シフト表の下には様々な操作を行うボタンが用意されています。</p>
                    </li>
                    <li class="item" id="make_shift/reset">
                        <h3>シフト表リセットボタン</h3>
                        <p>シフト表の勤務日時が入力されているエリアの文字と背景色をリセットします。リセットする前には確認ダイアログが出ます。</p>
                    </li>
                    <li class="item" id="make_shift/get_time">
                        <h3>シフト時間帯取得</h3>
                        <p>入力されているシフトの勤務の要素をB21セル以下に抽出します。すでにB21以下セルに入力されている場合は上書きせず、無かった場合は要素を追加します。</p>
                        <img class="img_small" src="document/image/make_shift_2.png" alt="シフト表取得">
                    </li>
                    <li class="item" id="make_shift/color">
                        <h3>セルの色設定</h3>
                         <p>B21セル以下に入力された時間帯の右のセル背景色をシフト表に反映します。B21セル以下の色設定は以前のシフト表ファイルからコピペして貼った場合もきちんと反映されます。</p>
                    </li>
                </ul>
            </li>
            <li class="content" id="error">
                <h2>エラー処理＆困った時の処理リスト</h2>
                <ul>
                    <li class="item" id="error/outline">
                        <h3>バグの報告</h3>
                         <p>
                             予約表のマクロはGitHubにアップロードしています。<br>
                             URL　 <a href="https://github.com/Yu0727Harada/xlAres">https://github.com/Yu0727Harada/xlAres</a><br>
                             バグ報告、プルリクエストなどしていただいてもちろんかまいませんので使える人はそちらからどうぞ。<br>
                             予約表を操作しているとエラーにであうことがあると思います。その時の対処法を書いていきます。エラーには2種類あります。１つ目は予約表固有エラー、２つ目はVBAエラーです。
                         </p>
                    </li>
                    <li class="item" id="error/known">
                        <h3>予約表固有エラー</h3>
                            マクロ作成者がすでにエラーを認識、原因を解明しているため、エラーが発生した際にメッセージボックスにエラー番号が記載されています。以下に各エラー番号ごとの対処法がありますで、これを参考に対処してください。
                            <ul>
                                <li>
                                    <h4>:エラー002</h4>
                                    <p>
                                        予約表ファイルはマクロで自動的に保護されるようになっています。それによりセルの背景色を変更する際に、変更できずにエラーが出ることがあります。特に初めてのPCで開いた際に起こりますが一度設定すると発生しなくなります。<br>
                                        解決策　校閲のシートの保護の解除をクリック。校閲がない場合（リボンが表示されていない時）には<a href="#control_panel/bottom/view_option">コントロールパネルの表示/非表示設定からリボンを表示</a>を押します。<br>
                                        <img class="img_small" src="document/image/error_1.png" alt="エラー002＿1"><br>
                                        シートの保護に変わるのでもう一度クリック<br>
                                        <img class="img_small" src="document/image/error_2.png" alt="エラー002＿2"><br>
                                        セルの書式設定のチェックボックスにチェックを入れてOKボタンを押します。<br>
                                        <img class="img_small" src="document/image/error_3.png" alt="エラー002＿3"><br>
                                    </p>
                                </li>
                                <li>
                                    <h4>:エラー番号101</h4>
                                    <p>
                                        通常起こりえないエラーです。原因としてはきちんと生データがソートされていない、ソートされていない状態で予約などを行なったために予約データが重複していると考えられます。まずは<a href="#control_panel/bottom/execute/data_sort">LAコントロールパネルで生データをソート</a>してください。それでもエラーが出る場合は、生データシートを直接見て、同じ時間帯、席番号が被っているデータを削除してください。
                                    </p>
                                </li>
                                <li>
                                    <h4>：エラー番号102</h4>
                                    <p>
                                        予約を削除する際にその人の1日の予約数を減少させようとしたら、その人の学籍番号が見つからなかった場合のエラーです。原因としては重複チェックシートや<a href="#administer/edit_raw_data">生データを直接編集</a>した際に起こると思います。特に影響はないですが、LAコントロールパネルで<a href="#control_panel/bottom/execute/refresh_duplicate">重複チェックシートリフレッシュ</a>を行うとよいと思います。
                                    </p>
                                </li>
                                <li>
                                    <h4>：エラー番号103</h4>
                                    <p>
                                        予約を削除する際に生データを検索したら予約が見つからなかった場合です。通常ありえません。生データシートの予約コードが何らかの要因で直接編集された、あるいは予約表の数式が変更されたことも考えられます。バックアップの予約表の数式をコピーして貼り付けるなどしてください。
                                    </p>
                                </li>
                                <li>
                                    <h4>：エラー番号２０１</h4>
                                    <p>
                                        シフト表に読み込まれている番号が出力シートのプロフィールシートに存在しない場合のエラーです。エラーが出た場合はその番号のプロフィール表示をスキップし、モジュール１のshift_profile_countで指定した数までプロフィールの表示を続けます。<br>
                                        <img class="img_small" src="document/image/error_4.png" alt="エラー201_1"><br>
                                        例）その時のシフトが３、１０、１５番号で１０番のプロフィールがなかった場合、３と１５番のプロフィールを表示します。<br>
                                        また、更新のたびにエラーを吐きますので、プロフィール番号が間違えた場合などはそこを修正。そもそもプロフィールを用意していない場合などはシフト表の番号を０に設定しましょう。０はエラーなしで表示をスキップします。<br>
                                        例）シフトを３、０、１５に設定するとエラーなしで３と１５番のプロフィールを表示します。</p>
                                </li>
                            </ul>

                    </li>
                    <li class="item" id="error/unknown">
                        <h3>VBAエラー</h3>
                        <p>
                            作成者が予期していない、あるいは予期していても防ぐことが難しい場合は発生します。こんな感じのが出てきます。<br>
                            <img class="img_small" src="document/image/vbaerror.png" alt="VBAエラー"><br>
                            終了を押して大概問題ありませんが、出来ればデバックボタンを押して、どの行でエラーが出たかスクショして報告してくれると開発に役立ちます。
                        </p>
                    </li>
                    <li class="">
                        <li class="item" id="error/work">
                            <h3>予約表に予約済と表示されない,予約表の背景色が設定されない,時計が更新されない,VBAエラーが表示されてしまう</h3>
                            <p>
                                <a href="#control_panel/bottom/execute">LAコントロールパネル</a>をガチャ押しで対処できます。あるいはエクセルファイルを立ち上げなおしてください。それでも解決しない場合は新しいファイルを作成してください。この時、エラーの原因が生データやシフト表などのデータの可能性が高いため、<a
                                    href="#control_panel/bottom/develop/update">データは引き継がず</a>削除してください。
                            </p>
                        </li>
                        <li class="item" id="error/macro">
                            <h3>マクロが起動しない</h3>
                            <p>
                                マクロが無効になっているかもしれません。グーグル先生に「マクロ　有効にする」でググりましょう。<br>
                                デバックモードになっている可能性があります。<a href="#control_panel/bottom/develop/open_editor">VisualBasicEditorを開きます。</a>中断と出ている場合でバックモードです。三角ボタンを押すとマクロが起動するようになります。<br>
                                <img class="img_small" src="document/image/not_up_macro.png" alt="マクロが起動しない"><br>
                                途中でデバックモードを挟むと再計算が定期的に実行されなくなる場合があります。表に色がつかないなどの不具合があった場合はLAコントロールパネルの定期再計算再実行ボタンを押してください。
                            </p>
                        </li>
                    </li>
                </ul>
            </li>

            <li class="content" id="implementation">
                <h2>開発を進める上での基本的な仕様</h2>
                <p>
                    このエクセルマクロ作った人間は今までプログラミングのプの字もやったことなかった人間が手探りで作ったものです。そのため、変数は全然リーダブルじゃないし、全体的に処理が冗長です。お願いなのでスマートな処理に直してください。<br>
                    開発自体は途中からGitHubをつかってやってるので、GitHubのほうから編集していただくとスマートかと思います。<br>
                    オープンレポジトリにしたので自由に更新できます。URL　<a href="https://github.com/Yu0727Harada/xlAres">https://github.com/Yu0727Harada/xlAres</a></p>
                <ul>
                    <li class="item" id="implementation/outline">
                        <h3>全体の概要</h3>
                            <img class="img_small" src="document/image/entire_gragh.png" alt="全体の概要">
                    </li>
                    <li class="item" id="implementation/cell_formula">
                        <h3>メインシートの表のセル内の式</h3>
                        <p>
                           =IF(ISNUMBER(IF(INDEX(生データ!$D:$D,MATCH(D22,生データ!$D:$D,1))=D22,VLOOKUP(D22,生データ!$D:$F,3,TRUE),)),get_view_string(COLUMN(C4)-2)&IF(VLOOKUP(D22,生データ!$D:$F,2,TRUE)=1,CHAR(10)&"(貸出中)",""),IF(INDEX(生データ!$D:$D,MATCH(D22,生データ!$D:$D,1))=D22,VLOOKUP(D22,生データ!$D:$F,3,TRUE),""))<br>
                           Vlookupは重くなるのでindex&matchの二分探索に切り替えました。CHAR(10)は改行。基本構造は上と同じです。<br>
                           D22セル周辺には予約コードが非表示で置いてあります。<br>
                           前から三つ目のif文の説明です。Index＋match関数で一致する予約コードがあるか確認します。Trueの場合はVLOOKUP関数のTrueで二分探索を行います。Falseの場合の処理はなし。<br>
                           上のif文の結果、IsNumber関数にはVLOOKUPした学籍番号が入ります。そのため、If文のTrueの場合（IsNumberがTrueの時＝きちんと学籍番号が入っていた場合）予約済と表示し、かつ（＆で文字列の連結）VLOOKUPでケーブルの貸し出しの有無を探索して、１だったら改行コードCHAR(10)を挟んで貸し出し中と表示、１でないなら何もなし。<br>
                           If文がFalseの場合（学籍番号ではなく文字列が入っていた場合）もう一度Index＋Matchで探索し（なぜか必要）、一致したらVLOOKUPの出てきた値をそのまま表示、一致しなかった場合は“”を出力。（この処理は文字列を生データに入力するとその文字列が表に表示されるという使用を実装するために入れています）（9/29追記ここまで）<br>
                           マクロに記述してある、時間帯に応じて文字列を返すGet_view_string関数を用いることで時間帯に応じて「予約済」、「使用中」、「使用済」を表示することができます。<br>
                        </p>
                    </li>
                    <li class="item" id="implementation/export_macro">
                        <h3>vbac.wsfファイルの使い方</h3>
                        <p>
                            <a href="http://igeta-diary.blogspot.com/2014/03/what-is-vbac.html">http://igeta-diary.blogspot.com/2014/03/what-is-vbac.html</a>を参考にしてください。コマンドプロンプトでエクセルファイルのある親フォルダに移動してcscript vbac.wsf decombine　をするとエクセルのマクロをテキスト化してくれます。
                        </p>
                    </li>
                </ul>
            </li>
         </ol>
    </body>    
     <script type="text/javascript">
        function image_view(){

            let ele = document.getElementsByClassName('img_small');

            for(let i=0;i<ele.length;i++){
                ele[i].style.width = 'auto';
                if(ele[i].naturalWidth >= document.body.offsetWidth){

                    ele[i].style.width = '90%';
                }else{
                    ele[i].style.width = '${ele[i].naturalWidth}px';

                }
                ele[i].style.height = 'auto';
                ele[i].style.padding = '20px';
            }
        }

        window.onload = function(){
            image_view();
        };
        window.onresize = function(){
            image_view();
        };

    </script>




</html>
